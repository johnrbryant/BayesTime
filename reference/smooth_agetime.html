<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Smooth rates over age and time — smooth_agetime • BayesRates</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Smooth rates over age and time — smooth_agetime"><meta name="description" content="Use data on numbers of events and population
at risk to produce estimates of rates that
are smoothed over age and time. The amount of smoothing
depends on the model used to represent age
and time effects. Current choices for
age effects are Spline() (the default) and
RW2(). Current choices for time effects are
TimeVarying() (the default) and TimeFixed().
See the documentation for Spline(), RW2(),
TimeVarying(), and TimeFixed() for a
description of the mathematical models
underlying the smoothing."><meta property="og:description" content="Use data on numbers of events and population
at risk to produce estimates of rates that
are smoothed over age and time. The amount of smoothing
depends on the model used to represent age
and time effects. Current choices for
age effects are Spline() (the default) and
RW2(). Current choices for time effects are
TimeVarying() (the default) and TimeFixed().
See the documentation for Spline(), RW2(),
TimeVarying(), and TimeFixed() for a
description of the mathematical models
underlying the smoothing."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesRates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vig1_nz.html">Divorces in New Zealand</a></li>
    <li><a class="dropdown-item" href="../articles/vig2_cn.html">Divorces in China</a></li>
    <li><a class="dropdown-item" href="../articles/vig3_math.html">vig3_math</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Smooth rates over age and time</h1>

      <div class="d-none name"><code>smooth_agetime.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use data on numbers of events and population
at risk to produce estimates of rates that
are smoothed over age and time. The amount of smoothing
depends on the model used to represent age
and time effects. Current choices for
age effects are <code><a href="Spline.html">Spline()</a></code> (the default) and
<code><a href="RW2.html">RW2()</a></code>. Current choices for time effects are
<code><a href="TimeVarying.html">TimeVarying()</a></code> (the default) and <code><a href="TimeFixed.html">TimeFixed()</a></code>.
See the documentation for <code><a href="Spline.html">Spline()</a></code>, <code><a href="RW2.html">RW2()</a></code>,
<code><a href="TimeVarying.html">TimeVarying()</a></code>, and <code><a href="TimeFixed.html">TimeFixed()</a></code> for a
description of the mathematical models
underlying the smoothing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth_agetime</span><span class="op">(</span></span>
<span>  <span class="va">nevent_df</span>,</span>
<span>  <span class="va">py_df</span>,</span>
<span>  agevar <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  byvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  age_width_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  age_min <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spec_age <span class="op">=</span> <span class="fu"><a href="Spline.html">Spline</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  spec_time <span class="op">=</span> <span class="fu"><a href="TimeVarying.html">TimeVarying</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nevent-df">nevent_df<a class="anchor" aria-label="anchor" href="#arg-nevent-df"></a></dt>
<dd><p>A data frame with a column
called <code>"nevent"</code> containing the number of events,
plus additional classification variables.</p></dd>


<dt id="arg-py-df">py_df<a class="anchor" aria-label="anchor" href="#arg-py-df"></a></dt>
<dd><p>A data frame with a column called <code>"py"</code>
containing exposure, plus additional
classification variables.</p></dd>


<dt id="arg-agevar">agevar<a class="anchor" aria-label="anchor" href="#arg-agevar"></a></dt>
<dd><p>The name of the age variable in
<code>nevent_df</code> and <code>py_df</code>.
Defaults to <code>"age"</code>.</p></dd>


<dt id="arg-timevar">timevar<a class="anchor" aria-label="anchor" href="#arg-timevar"></a></dt>
<dd><p>The name of the time variable in
<code>nevent_df</code> and <code>py_df</code>.
Defaults to <code>"time"</code>.</p></dd>


<dt id="arg-byvar">byvar<a class="anchor" aria-label="anchor" href="#arg-byvar"></a></dt>
<dd><p>The names of classification variables in <code>nevent_df</code>
and <code>py_df</code>, other than age and time (eg <code>"sex"</code> or <code>"region"</code>).
Optional.</p></dd>


<dt id="arg-age-width-df">age_width_df<a class="anchor" aria-label="anchor" href="#arg-age-width-df"></a></dt>
<dd><p>A data frame with columns <code>"age"</code>
and <code>"width"</code>, giving the widths of each age group.
Required if the age group labels are not integers.</p></dd>


<dt id="arg-age-min">age_min<a class="anchor" aria-label="anchor" href="#arg-age-min"></a></dt>
<dd><p>The lower limit of the youngest age group.
Required if the age group labels are not integers.</p></dd>


<dt id="arg-spec-age">spec_age<a class="anchor" aria-label="anchor" href="#arg-spec-age"></a></dt>
<dd><p>The prior model for the age effect.
Current choices: <code><a href="Spline.html">Spline()</a></code> and <code><a href="RW2.html">RW2()</a></code>. Defaults to
<code><a href="Spline.html">Spline()</a></code>.</p></dd>


<dt id="arg-spec-time">spec_time<a class="anchor" aria-label="anchor" href="#arg-spec-time"></a></dt>
<dd><p>The prior model for the time effect.
Current choices: <code><a href="TimeFixed.html">TimeFixed()</a></code> and <code><a href="TimeVarying.html">TimeVarying()</a></code>.
Defaults to <code><a href="TimeVarying.html">TimeVarying()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"BayesRates_results"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Dataset <code>nevent_df</code> must contain a
variable called <code>nevent</code> giving counts of events,
and dataset <code>py_df</code> must contain a variable called
<code>py</code> giving the population at risk.</p>
<p><code>nevent_df</code> and <code>py_df</code> must also contain
an age variable. If the age variable users multi-year
age groups (eg <code>"15-19"</code> or <code>"65+"</code>), then
<code><a href="smooth_age.html">smooth_age()</a></code> needs help interpreting these age groups.
A data frame <code>age_width_df</code> must be supplied giving
the width of each age group, as well as a
value <code>age_min</code> giving the lower limit of the
youngest age group. (Future versions of <code>BayesRates</code>
will try to parse age group labels automatically.)</p>
<p><code>nevent_df</code> and <code>py_df</code> must contain a time variable.
To analyse data without a time dimension, use
function <code><a href="smooth_age.html">smooth_age()</a></code>. Times must be single
years, eg <code>2015</code>, <code>2016</code>, <code>2017</code>. There may be gaps,
eg <code>2010</code>, <code>2015</code>, <code>2020</code>: <code>smooth_agetime()</code>
automatically estimates values for the
missing periods.</p>
<p><code>nevent_df</code> and <code>py_df</code> can contain additional
classifying variables, such as sex and region.
Independent models are fitted for each combination
of the levels of these additional variables.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="smooth_age.html">smooth_age()</a></code> models rates that do not have
a time dimension.</p></li>
<li><p><code><a href="Spline.html">Spline()</a></code> and <code><a href="RW2.html">RW2()</a></code> specify age effects</p></li>
<li><p><code><a href="TimeVarying.html">TimeVarying()</a></code> and <code><a href="TimeFixed.html">TimeFixed()</a></code> specify time effects</p></li>
<li><p><code><a href="augment.BayesRates_results.html">augment()</a></code>
combines data and estimates for rates.</p></li>
<li><p><code><a href="components.BayesRates_results.html">components()</a></code>
extracts rates, age effects,
time effects, and hyper-parameters.</p></li>
<li><p><code><a href="n_draw.html">n_draw()</a></code> sets the default number
of draws from the posterior distribution.</p></li>
<li><p><code><a href="total_rate.html">total_rate()</a></code> calculates a summary indicator.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">smooth_agetime</span><span class="op">(</span>nevent_df <span class="op">=</span> <span class="va">nz_divorces</span>,</span></span>
<span class="r-in"><span>                          py_df <span class="op">=</span> <span class="va">nz_population</span>,</span></span>
<span class="r-in"><span>                          age_width_df <span class="op">=</span> <span class="va">nz_age_width_df</span>,</span></span>
<span class="r-in"><span>                          age_min <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Object of class "BayesRates_results" ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      nevent ~ Poisson(rate * py)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   log(rate) = age_effect + time_effect</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  age_effect ~ Spline()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time_effect ~ TimeVarying()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    agevar: age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   timevar: time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     byvar: &lt;none&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    n_draw: 1000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Bryant, Junni Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

