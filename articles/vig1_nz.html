<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BayesRates">
<title>vig1_nz • BayesRates</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="vig1_nz">
<meta property="og:description" content="BayesRates">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BayesRates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vig1_nz.html">vig1_nz</a>
    <a class="dropdown-item" href="../articles/vig2_cn.html">vig2_cn</a>
    <a class="dropdown-item" href="../articles/vig3_math.html">vig3_math</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>vig1_nz</h1>
            
      
      
      <div class="d-none name"><code>vig1_nz.Rmd</code></div>
    </div>

    
    
<p>In this example, we have the number of divorce events and
person-years of exposure for New Zealand by age groups (15-19, 20-24, …,
65+), sex, and year (1992, …, 2021). The values of the person-years of
exposure are quite large and thus sampling error is not very large.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://junnizhang.github.io/BayesRates/">BayesRates</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>‘nz_divorces’ is an existing data frame in the <em>BayesRates</em>
package with four columns:<br>
(1) ‘age’: a factor variable with levels being
“15-19”,“20-24”,…,“60-64”,“65+”;<br>
(2) ‘sex’: a character variable with possible values being “Female” and
“Male”;<br>
(3) ‘time’: an integer variable with possible values being
1992,…,2021;<br>
(4) ‘nevent’: a numeric variable recording the number of divorce
events.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nz_divorces</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   age   sex     time nevent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female  <span style="text-decoration: underline;">1</span>992     12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Female  <span style="text-decoration: underline;">1</span>993      6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 15-19 Female  <span style="text-decoration: underline;">1</span>994      9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15-19 Female  <span style="text-decoration: underline;">1</span>995      6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 15-19 Female  <span style="text-decoration: underline;">1</span>996      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 15-19 Female  <span style="text-decoration: underline;">1</span>997      9</span></span></code></pre></div>
<p>‘nz_population’ is an existing data frame in the <em>BayesRates</em>
package with four columns:<br>
(1) ‘age’: a factor variable with levels being
“15-19”,“20-24”,…,“60-64”,“65+”;<br>
(2) ‘sex’: a character variable with possible values being “Female”,
“Male”;<br>
(3) ‘time’: an integer variable with possible values being
1992,…,2021;<br>
(4) ‘py’: a numeric variable recording person-years of exposure.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nz_population</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   age   sex     time     py</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female  <span style="text-decoration: underline;">1</span>992 <span style="text-decoration: underline;">139</span>500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Female  <span style="text-decoration: underline;">1</span>993 <span style="text-decoration: underline;">135</span>510</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 15-19 Female  <span style="text-decoration: underline;">1</span>994 <span style="text-decoration: underline;">133</span>010</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15-19 Female  <span style="text-decoration: underline;">1</span>995 <span style="text-decoration: underline;">131</span>960</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 15-19 Female  <span style="text-decoration: underline;">1</span>996 <span style="text-decoration: underline;">132</span>490</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 15-19 Female  <span style="text-decoration: underline;">1</span>997 <span style="text-decoration: underline;">132</span>590</span></span></code></pre></div>
<p>The person-years of exposure are quite large, and correspondingly the
numbers of divorces are not small.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nz_population</span><span class="op">[</span><span class="st">"py"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;        py        </span></span>
<span><span class="co">#&gt;  Min.   : 68470  </span></span>
<span><span class="co">#&gt;  1st Qu.:130178  </span></span>
<span><span class="co">#&gt;  Median :145890  </span></span>
<span><span class="co">#&gt;  Mean   :151497  </span></span>
<span><span class="co">#&gt;  3rd Qu.:160290  </span></span>
<span><span class="co">#&gt;  Max.   :434780</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">nz_divorces</span><span class="op">[</span><span class="st">"nevent"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; nevent</span></span>
<span><span class="co">#&gt;    0    3    6    9   12   36   54   63   66   69   72   75   78   84   96   99 </span></span>
<span><span class="co">#&gt;   30   15   11    3    1    1    2    1    1    1    2    1    1    2    2    1 </span></span>
<span><span class="co">#&gt;  102  108  111  114  120  123  129  132  135  138  141  144  147  150  153  156 </span></span>
<span><span class="co">#&gt;    2    2    1    2    1    3    2    6    4    2    1    2    3    3    1    3 </span></span>
<span><span class="co">#&gt;  159  162  165  168  171  174  177  183  186  189  195  207  219  222  225  228 </span></span>
<span><span class="co">#&gt;    1    1    3    3    1    4    1    1    1    1    2    4    2    1    3    3 </span></span>
<span><span class="co">#&gt;  237  240  243  252  255  258  261  270  273  276  279  282  285  288  291  294 </span></span>
<span><span class="co">#&gt;    1    1    2    2    1    2    2    2    1    3    2    2    3    1    3    2 </span></span>
<span><span class="co">#&gt;  297  303  306  309  312  315  318  324  327  330  339  342  348  351  354  357 </span></span>
<span><span class="co">#&gt;    2    1    2    1    3    2    3    1    1    1    1    1    1    2    2    1 </span></span>
<span><span class="co">#&gt;  360  366  369  372  375  378  381  384  387  393  396  402  405  408  411  414 </span></span>
<span><span class="co">#&gt;    2    2    1    1    2    2    2    4    1    1    1    2    1    1    1    1 </span></span>
<span><span class="co">#&gt;  417  420  423  426  429  432  435  438  441  450  453  459  471  480  483  489 </span></span>
<span><span class="co">#&gt;    1    1    1    2    2    2    2    3    1    2    2    1    1    1    1    1 </span></span>
<span><span class="co">#&gt;  498  501  504  507  510  513  519  525  528  531  534  537  543  546  549  552 </span></span>
<span><span class="co">#&gt;    1    4    1    1    1    1    1    1    1    1    1    1    2    2    1    2 </span></span>
<span><span class="co">#&gt;  555  558  564  567  570  573  582  585  594  597  600  603  606  609  618  621 </span></span>
<span><span class="co">#&gt;    1    2    3    1    2    1    3    3    1    1    1    1    1    1    1    1 </span></span>
<span><span class="co">#&gt;  630  633  636  639  645  648  654  657  663  675  681  687  690  693  699  705 </span></span>
<span><span class="co">#&gt;    2    2    1    1    2    1    1    1    1    1    1    3    1    1    1    1 </span></span>
<span><span class="co">#&gt;  708  711  723  726  729  732  750  756  759  765  774  786  801  804  810  813 </span></span>
<span><span class="co">#&gt;    2    1    1    1    1    2    2    2    1    1    2    1    1    2    1    1 </span></span>
<span><span class="co">#&gt;  819  822  828  831  834  837  840  846  849  852  855  858  864  867  870  873 </span></span>
<span><span class="co">#&gt;    1    1    1    2    1    2    1    1    3    1    3    1    2    1    3    2 </span></span>
<span><span class="co">#&gt;  876  879  882  888  903  906  909  912  915  924  930  933  942  945  948  954 </span></span>
<span><span class="co">#&gt;    1    2    1    1    1    1    1    1    3    3    1    2    1    1    1    1 </span></span>
<span><span class="co">#&gt;  957  960  969  975  978  990  996 1005 1008 1011 1014 1017 1026 1029 1032 1041 </span></span>
<span><span class="co">#&gt;    1    1    1    1    1    1    1    2    3    3    1    2    3    1    1    1 </span></span>
<span><span class="co">#&gt; 1044 1047 1050 1053 1059 1065 1074 1077 1080 1086 1089 1092 1095 1098 1101 1104 </span></span>
<span><span class="co">#&gt;    2    2    2    2    2    1    1    2    1    1    1    1    1    3    1    4 </span></span>
<span><span class="co">#&gt; 1110 1113 1116 1122 1125 1128 1134 1146 1152 1161 1164 1185 1191 1194 1203 1206 </span></span>
<span><span class="co">#&gt;    2    4    1    1    2    1    2    1    1    3    1    1    1    1    1    1 </span></span>
<span><span class="co">#&gt; 1209 1212 1215 1224 1227 1233 1236 1239 1254 1257 1260 1263 1266 1269 1278 1281 </span></span>
<span><span class="co">#&gt;    1    3    2    1    1    1    2    3    3    1    1    2    1    2    2    2 </span></span>
<span><span class="co">#&gt; 1287 1290 1299 1317 1326 1338 1344 1347 1359 1362 1368 1383 1386 1389 1392 1395 </span></span>
<span><span class="co">#&gt;    2    1    1    1    1    1    1    1    1    1    2    1    2    2    1    1 </span></span>
<span><span class="co">#&gt; 1398 1407 1410 1419 1422 1425 1428 1446 1449 1452 1461 1470 1473 1482 1485 1494 </span></span>
<span><span class="co">#&gt;    1    3    1    3    1    2    1    1    1    2    2    2    1    1    4    2 </span></span>
<span><span class="co">#&gt; 1500 1503 1506 1515 1518 1521 1524 1530 1533 1542 1551 1560 1563 1572 1578 1587 </span></span>
<span><span class="co">#&gt;    1    1    3    1    1    1    1    2    1    3    2    2    3    1    1    2 </span></span>
<span><span class="co">#&gt; 1590 1593 1596 1608 1611 1614 1623 1626 1647 1656 1659 1662 1674 1680 1683 1689 </span></span>
<span><span class="co">#&gt;    3    1    1    1    4    2    1    2    1    1    1    2    1    1    1    3 </span></span>
<span><span class="co">#&gt; 1692 1695 1701 1710 1713 1719 1722 1725 1743 1755 1761 1767 1776 1785 1791 1794 </span></span>
<span><span class="co">#&gt;    1    1    1    1    1    1    1    1    2    3    1    1    1    1    1    1 </span></span>
<span><span class="co">#&gt; 1797 1806 1827 1833 1839 1842 1845 1851 1857 1860 1872 1875 1878 1884 1893 1896 </span></span>
<span><span class="co">#&gt;    2    3    1    1    1    3    1    1    1    1    1    1    1    1    1    1 </span></span>
<span><span class="co">#&gt; 1902 1908 1911 1914 1926 1932 1935 1938 1956 1959 1965 1968 1971 1974 1980 1992 </span></span>
<span><span class="co">#&gt;    1    1    2    1    1    1    1    1    1    1    1    1    2    1    1    1 </span></span>
<span><span class="co">#&gt; 1998 2001 2013 2025 2028 2037 2040 2046 2052 2055 2061 2079 </span></span>
<span><span class="co">#&gt;    1    1    1    1    1    1    1    1    1    2    1    1</span></span></code></pre></div>
<p>We keep the subsets of ‘nz_divorces’ and ‘nz_population’ for 2020,
and remove the ‘time’ variable. To do this, we use the ‘%&gt;%’ operator
from the ‘dplyr’ package that turns ‘x %&gt;% f(y)’ into ‘f(x,y)’ so
that the result from one step is piped into the next step.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nz_divorce_2020</span> <span class="op">&lt;-</span> <span class="va">nz_divorces</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nz_popn_2020</span> <span class="op">&lt;-</span> <span class="va">nz_population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">time</span><span class="op">)</span></span></code></pre></div>
<p>We use the <em>smooth_age</em> function to smooth the observed unisex
rates across age. The parameter <em>nevent_df</em> specifies the data
frame for numbers of events, and the parameter <em>py_df</em> specifies
the data frame for person years of exposure. When we work with age
groups, we also need to specify the parameter <em>age_width_df</em>
which is a data frame recording the width of each age group, and the
parameter <em>age_min</em> which is the starting age. As input to the
parameter <em>age_width_df</em>, we use ‘nz_age_width_df’, an existing
data frame in the <em>BayesRates</em> package that gives the width of
each age group.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nz_age_width_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   age   width</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 20-24     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 25-29     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 30-34     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 35-39     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 40-44     5</span></span>
<span></span>
<span><span class="va">res_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age.html">smooth_age</a></span><span class="op">(</span>nevent_df <span class="op">=</span> <span class="va">nz_divorce_2020</span>,</span>
<span>                      py_df <span class="op">=</span> <span class="va">nz_popn_2020</span>,</span>
<span>                      age_width_df <span class="op">=</span> <span class="va">nz_age_width_df</span>,</span>
<span>                      age_min <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Inside the <em>smooth_age</em> function, numbers of events and
person-years of exposure for females and males are aggregated. The
default model for the age effects on log rates is a spline model with
degrees of freedom equal to max(ceiling(0.7 * n), 4), where n is the
number of age groups. Here we have n=11, hence the degrees of freedom is
8.</p>
<p>We print the model specification as follows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_age</span></span>
<span><span class="co">#&gt; --- Object of class "BayesRates_results" ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      nevent ~ Poisson(rate * py)</span></span>
<span><span class="co">#&gt;   log(rate) = age_effect</span></span>
<span><span class="co">#&gt;  age_effect ~ Spline()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    agevar: age</span></span>
<span><span class="co">#&gt;     byvar: &lt;none&gt;</span></span>
<span><span class="co">#&gt;    n_draw: 1000</span></span></code></pre></div>
<p>The number of events is modeled by a Poisson distribution with mean
equal to an underlying rate multiplied by person-years of exposure. The
logarithm of the underlying rate equals the age effect, which is modeled
by a spline model. The model for the age effect is <em>Spline()</em>.
The value of ‘agevar’ is ‘age’, indicating that the name of the variable
that records age is ‘age’. The value of ‘byvar’ is empty, indicating
that we fit a single model (not classified by any variable). The value
of ‘ndraw’ is 1000, indicating that the number of posterior draws is
1000 (default value).</p>
<p>We use the <em>components</em> function to extract model-based
estimates of rates disaggregated by age.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="va">res_age</span>, what <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 6</span></span></span>
<span><span class="co">#&gt;    age   age.mid   .fitted    .lower    .upper .probability </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 15-19    17.5 0.000<span style="text-decoration: underline;">020</span>1 0.000<span style="text-decoration: underline;">010</span>6 0.000<span style="text-decoration: underline;">038</span>8 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 20-24    22.5 0.000<span style="text-decoration: underline;">495</span>  0.000<span style="text-decoration: underline;">434</span>  0.000<span style="text-decoration: underline;">564</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 25-29    27.5 0.002<span style="text-decoration: underline;">66</span>   0.002<span style="text-decoration: underline;">53</span>   0.002<span style="text-decoration: underline;">80</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 30-34    32.5 0.005<span style="text-decoration: underline;">23</span>   0.005<span style="text-decoration: underline;">04</span>   0.005<span style="text-decoration: underline;">42</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 35-39    37.5 0.006<span style="text-decoration: underline;">29</span>   0.006<span style="text-decoration: underline;">10</span>   0.006<span style="text-decoration: underline;">51</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 40-44    42.5 0.007<span style="text-decoration: underline;">02</span>   0.006<span style="text-decoration: underline;">84</span>   0.007<span style="text-decoration: underline;">22</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 45-49    47.5 0.007<span style="text-decoration: underline;">24</span>   0.007<span style="text-decoration: underline;">02</span>   0.007<span style="text-decoration: underline;">48</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 50-54    52.5 0.006<span style="text-decoration: underline;">38</span>   0.006<span style="text-decoration: underline;">18</span>   0.006<span style="text-decoration: underline;">58</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 55-59    57.5 0.004<span style="text-decoration: underline;">95</span>   0.004<span style="text-decoration: underline;">75</span>   0.005<span style="text-decoration: underline;">13</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 60-64    62.5 0.003<span style="text-decoration: underline;">26</span>   0.003<span style="text-decoration: underline;">07</span>   0.003<span style="text-decoration: underline;">46</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 65+      72.5 0.001<span style="text-decoration: underline;">21</span>   0.001<span style="text-decoration: underline;">14</span>   0.001<span style="text-decoration: underline;">30</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span></code></pre></div>
<p>In the returned data frame, the variable ‘age.mid’ gives the middle
point for each age group, the variable ‘.fitted’ gives the point
estimate of the rate, the variables ‘.lower’ and ‘.upper’ give the lower
and upper bounds of the credible interval of the rate (95% credible
interval by default), and the variable ‘.probability’ gives a list
containing the posterior draws of the rate.</p>
<p>We also use the <em>components</em> function to extract model-based
estimates of age effects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="va">res_age</span>, what <span class="op">=</span> <span class="st">"age_effect"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 6</span></span></span>
<span><span class="co">#&gt;    age   age.mid .fitted .lower .upper .probability </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 15-19    17.5  -<span style="color: #BB0000;">4.69</span>  -<span style="color: #BB0000;">5.27</span>  -<span style="color: #BB0000;">4.10</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 20-24    22.5  -<span style="color: #BB0000;">1.49</span>  -<span style="color: #BB0000;">1.60</span>  -<span style="color: #BB0000;">1.37</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 25-29    27.5   0.195  0.109  0.275 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 30-34    32.5   0.871  0.799  0.942 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 35-39    37.5   1.06   0.988  1.13  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 40-44    42.5   1.16   1.10   1.24  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 45-49    47.5   1.20   1.13   1.27  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 50-54    52.5   1.07   1.00   1.14  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 55-59    57.5   0.816  0.743  0.886 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 60-64    62.5   0.400  0.313  0.489 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 65+      72.5  -<span style="color: #BB0000;">0.587</span> -<span style="color: #BB0000;">0.677</span> -<span style="color: #BB0000;">0.502</span> <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span></code></pre></div>
<p>We use the <em>augment</em> function to combine the observed data
with the model-based estimates of rates.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates_age_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">res_age</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rates_age_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   age   sex    nevent     py age.mid   .fitted    .lower    .upper .probability </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female      0 <span style="text-decoration: underline;">154</span>480    17.5 0.000<span style="text-decoration: underline;">020</span>1 0.000<span style="text-decoration: underline;">010</span>6 0.000<span style="text-decoration: underline;">038</span>8 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Male        0 <span style="text-decoration: underline;">162</span>910    17.5 0.000<span style="text-decoration: underline;">020</span>1 0.000<span style="text-decoration: underline;">010</span>6 0.000<span style="text-decoration: underline;">038</span>8 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 20-24 Female    111 <span style="text-decoration: underline;">163</span>370    22.5 0.000<span style="text-decoration: underline;">495</span>  0.000<span style="text-decoration: underline;">434</span>  0.000<span style="text-decoration: underline;">564</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 20-24 Male       54 <span style="text-decoration: underline;">175</span>600    22.5 0.000<span style="text-decoration: underline;">495</span>  0.000<span style="text-decoration: underline;">434</span>  0.000<span style="text-decoration: underline;">564</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 25-29 Female    639 <span style="text-decoration: underline;">187</span>000    27.5 0.002<span style="text-decoration: underline;">66</span>   0.002<span style="text-decoration: underline;">53</span>   0.002<span style="text-decoration: underline;">80</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 25-29 Male      429 <span style="text-decoration: underline;">195</span>310    27.5 0.002<span style="text-decoration: underline;">66</span>   0.002<span style="text-decoration: underline;">53</span>   0.002<span style="text-decoration: underline;">80</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: .observed &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Since the model has been constructed for unisex rate, the values of
‘.fitted’, ‘.lower’, ‘.upper’ and ‘.probability’ are the same for males
and females at the same age.</p>
<p>We plot the model-based estimates of rates (including point estimates
and credible intervals) and the observed rates (in blue), separately for
each sex.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rates_age_df</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, y <span class="op">=</span> <span class="va">.fitted</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.observed</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>We use the <em>total_rate</em> function to obtain estimates of the
unisex total rates.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/total_rate.html">total_rate</a></span><span class="op">(</span><span class="va">res_age</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   .fitted .lower .upper .probability  .observed</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   0.236  0.232  0.239 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.236</span></span></code></pre></div>
<p>We next fit a separate model for each sex. To do this, we set the
parameter <em>byvar</em> in the <em>smooth_age</em> function to
“sex”.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_age_bysex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age.html">smooth_age</a></span><span class="op">(</span>nevent_df <span class="op">=</span> <span class="va">nz_divorce_2020</span>,</span>
<span>                      py_df <span class="op">=</span> <span class="va">nz_popn_2020</span>,</span>
<span>                      age_width_df <span class="op">=</span> <span class="va">nz_age_width_df</span>,</span>
<span>                      age_min <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                      byvar <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="va">res_age_bysex</span></span>
<span><span class="co">#&gt; --- Object of class "BayesRates_results" ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      nevent ~ Poisson(rate * py)</span></span>
<span><span class="co">#&gt;   log(rate) = age_effect</span></span>
<span><span class="co">#&gt;  age_effect ~ Spline()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    agevar: age</span></span>
<span><span class="co">#&gt;     byvar: sex</span></span>
<span><span class="co">#&gt;    n_draw: 1000</span></span></code></pre></div>
<p>We combine observed data with model-based estimates of rates, plot
the results, and obtain estimates of total rates.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates_age_bysex_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">res_age_bysex</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rates_age_bysex_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   age   sex    nevent     py age.mid   .fitted    .lower    .upper .probability </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female      0 <span style="text-decoration: underline;">154</span>480    17.5 0.000<span style="text-decoration: underline;">036</span>4 0.000<span style="text-decoration: underline;">018</span>9 0.000<span style="text-decoration: underline;">068</span>2 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Male        0 <span style="text-decoration: underline;">162</span>910    17.5 0.000<span style="text-decoration: underline;">022</span>0 0.000<span style="text-decoration: underline;">011</span>1 0.000<span style="text-decoration: underline;">041</span>3 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 20-24 Female    111 <span style="text-decoration: underline;">163</span>370    22.5 0.000<span style="text-decoration: underline;">674</span>  0.000<span style="text-decoration: underline;">568</span>  0.000<span style="text-decoration: underline;">787</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 20-24 Male       54 <span style="text-decoration: underline;">175</span>600    22.5 0.000<span style="text-decoration: underline;">326</span>  0.000<span style="text-decoration: underline;">266</span>  0.000<span style="text-decoration: underline;">409</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 25-29 Female    639 <span style="text-decoration: underline;">187</span>000    27.5 0.003<span style="text-decoration: underline;">22</span>   0.003<span style="text-decoration: underline;">01</span>   0.003<span style="text-decoration: underline;">45</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 25-29 Male      429 <span style="text-decoration: underline;">195</span>310    27.5 0.002<span style="text-decoration: underline;">04</span>   0.001<span style="text-decoration: underline;">89</span>   0.002<span style="text-decoration: underline;">21</span>   <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: .observed &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rates_age_bysex_df</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, y <span class="op">=</span> <span class="va">.fitted</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.observed</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/total_rate.html">total_rate</a></span><span class="op">(</span><span class="va">res_age_bysex</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   sex    .fitted .lower .upper .probability  .observed</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Female   0.231  0.227  0.237 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Male     0.242  0.237  0.248 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.242</span></span></code></pre></div>
<p>We can also change the model specification. For example, we can use a
spline model with 9 degrees of freedom to smooth the observed rates
across age for each sex.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_age_bysex2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age.html">smooth_age</a></span><span class="op">(</span>nevent_df <span class="op">=</span> <span class="va">nz_divorce_2020</span>,</span>
<span>                      py_df <span class="op">=</span> <span class="va">nz_popn_2020</span>,</span>
<span>                      age_width_df <span class="op">=</span> <span class="va">nz_age_width_df</span>,</span>
<span>                      age_min <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                      byvar <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                      spec_age <span class="op">=</span> <span class="fu"><a href="../reference/Spline.html">Spline</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_age_bysex2</span></span>
<span><span class="co">#&gt; --- Object of class "BayesRates_results" ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      nevent ~ Poisson(rate * py)</span></span>
<span><span class="co">#&gt;   log(rate) = age_effect</span></span>
<span><span class="co">#&gt;  age_effect ~ Spline(df=9)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    agevar: age</span></span>
<span><span class="co">#&gt;     byvar: sex</span></span>
<span><span class="co">#&gt;    n_draw: 1000</span></span>
<span></span>
<span><span class="va">rates_age_bysex2_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">res_age_bysex2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rates_age_bysex2_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   age   sex    nevent     py age.mid   .fitted     .lower    .upper .probability</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female      0 <span style="text-decoration: underline;">154</span>480    17.5 0.000<span style="text-decoration: underline;">030</span>5 0.000<span style="text-decoration: underline;">015</span>7  0.000<span style="text-decoration: underline;">056</span>2 <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Male        0 <span style="text-decoration: underline;">162</span>910    17.5 0.000<span style="text-decoration: underline;">016</span>0 0.000<span style="text-decoration: underline;">007</span>69 0.000<span style="text-decoration: underline;">032</span>4 <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 20-24 Female    111 <span style="text-decoration: underline;">163</span>370    22.5 0.000<span style="text-decoration: underline;">632</span>  0.000<span style="text-decoration: underline;">533</span>   0.000<span style="text-decoration: underline;">758</span>  <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 20-24 Male       54 <span style="text-decoration: underline;">175</span>600    22.5 0.000<span style="text-decoration: underline;">309</span>  0.000<span style="text-decoration: underline;">244</span>   0.000<span style="text-decoration: underline;">385</span>  <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 25-29 Female    639 <span style="text-decoration: underline;">187</span>000    27.5 0.003<span style="text-decoration: underline;">38</span>   0.003<span style="text-decoration: underline;">17</span>    0.003<span style="text-decoration: underline;">64</span>   <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 25-29 Male      429 <span style="text-decoration: underline;">195</span>310    27.5 0.002<span style="text-decoration: underline;">12</span>   0.001<span style="text-decoration: underline;">94</span>    0.002<span style="text-decoration: underline;">30</span>   <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: .observed &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rates_age_bysex2_df</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, y <span class="op">=</span> <span class="va">.fitted</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.observed</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/total_rate.html">total_rate</a></span><span class="op">(</span><span class="va">res_age_bysex2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   sex    .fitted .lower .upper .probability  .observed</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Female   0.232  0.226  0.236 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Male     0.242  0.237  0.247 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.242</span></span></code></pre></div>
<p>We can also use a second order random walk model to smooth the
observed rates across age for each sex.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_age_bysex3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_age.html">smooth_age</a></span><span class="op">(</span>nevent_df <span class="op">=</span> <span class="va">nz_divorce_2020</span>,</span>
<span>                      py_df <span class="op">=</span> <span class="va">nz_popn_2020</span>,</span>
<span>                      age_width_df <span class="op">=</span> <span class="va">nz_age_width_df</span>,</span>
<span>                      age_min <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                      byvar <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>                      spec_age <span class="op">=</span> <span class="fu"><a href="../reference/RW2.html">RW2</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_age_bysex3</span></span>
<span><span class="co">#&gt; --- Object of class "BayesRates_results" ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      nevent ~ Poisson(rate * py)</span></span>
<span><span class="co">#&gt;   log(rate) = age_effect</span></span>
<span><span class="co">#&gt;  age_effect ~ RW2()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    agevar: age</span></span>
<span><span class="co">#&gt;     byvar: sex</span></span>
<span><span class="co">#&gt;    n_draw: 1000</span></span>
<span></span>
<span><span class="va">rates_age_bysex3_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">res_age_bysex3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rates_age_bysex3_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   age   sex    nevent     py age.mid   .fitted     .lower    .upper .probability</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female      0 <span style="text-decoration: underline;">154</span>480    17.5 0.000<span style="text-decoration: underline;">019</span>1 0.000<span style="text-decoration: underline;">005</span>68 0.000<span style="text-decoration: underline;">061</span>2 <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Male        0 <span style="text-decoration: underline;">162</span>910    17.5 0.000<span style="text-decoration: underline;">015</span>1 0.000<span style="text-decoration: underline;">005</span>50 0.000<span style="text-decoration: underline;">043</span>0 <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 20-24 Female    111 <span style="text-decoration: underline;">163</span>370    22.5 0.000<span style="text-decoration: underline;">655</span>  0.000<span style="text-decoration: underline;">540</span>   0.000<span style="text-decoration: underline;">785</span>  <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 20-24 Male       54 <span style="text-decoration: underline;">175</span>600    22.5 0.000<span style="text-decoration: underline;">298</span>  0.000<span style="text-decoration: underline;">235</span>   0.000<span style="text-decoration: underline;">386</span>  <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 25-29 Female    639 <span style="text-decoration: underline;">187</span>000    27.5 0.003<span style="text-decoration: underline;">41</span>   0.003<span style="text-decoration: underline;">16</span>    0.003<span style="text-decoration: underline;">69</span>   <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 25-29 Male      429 <span style="text-decoration: underline;">195</span>310    27.5 0.002<span style="text-decoration: underline;">18</span>   0.001<span style="text-decoration: underline;">99</span>    0.002<span style="text-decoration: underline;">39</span>   <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: .observed &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rates_age_bysex3_df</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, y <span class="op">=</span> <span class="va">.fitted</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.observed</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/total_rate.html">total_rate</a></span><span class="op">(</span><span class="va">res_age_bysex3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   sex    .fitted .lower .upper .probability  .observed</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Female   0.231  0.227  0.237 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Male     0.242  0.237  0.247 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.242</span></span></code></pre></div>
<p>Next, for each sex, we use data for all years and smooth the observed
rates across age and time. By default, we model the age effects on log
rates using a spline model with degrees of freedom equal to
max(ceiling(0.7 * n), 4), where n is the number of age groups, and allow
the time effects on log rates to vary for different age groups. A
correlated first-order random walk is used to model the time effects,
where the correlation is higher for age groups that are closer.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_agetime_bysex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_agetime.html">smooth_agetime</a></span><span class="op">(</span>nevent_df <span class="op">=</span> <span class="va">nz_divorces</span>,</span>
<span>                              py_df <span class="op">=</span> <span class="va">nz_population</span>,</span>
<span>                              age_width_df <span class="op">=</span> <span class="va">nz_age_width_df</span>,</span>
<span>                              age_min <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                              byvar <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="va">res_agetime_bysex</span></span>
<span><span class="co">#&gt; --- Object of class "BayesRates_results" ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      nevent ~ Poisson(rate * py)</span></span>
<span><span class="co">#&gt;   log(rate) = age_effect + time_effect</span></span>
<span><span class="co">#&gt;  age_effect ~ Spline()</span></span>
<span><span class="co">#&gt; time_effect ~ TimeVarying()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    agevar: age</span></span>
<span><span class="co">#&gt;   timevar: time</span></span>
<span><span class="co">#&gt;     byvar: sex</span></span>
<span><span class="co">#&gt;    n_draw: 1000</span></span></code></pre></div>
<p>In the model specification, the logarithm of the underlying rate
equals the age effect plus the time effect. The model for the time
effect is <em>TimeVarying()</em>. The value of ‘timevar’ is ‘time’,
indicating that the name of the variable that records time is ‘time’.
The value of ‘byvar’ is ‘sex’, indicating that a model is fitted
separately for each sex.</p>
<p>We use the <em>augment</em> function to combine data and model-based
estimates of rates, and plot the results.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates_agetime_bysex_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">res_agetime_bysex</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rates_agetime_bysex_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 11</span></span></span>
<span><span class="co">#&gt;   age   sex     time nevent     py age.mid  .fitted  .lower  .upper .probability</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 15-19 Female  <span style="text-decoration: underline;">1</span>992     12 <span style="text-decoration: underline;">139</span>500    17.5  5.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 4.23<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 6.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 Female  <span style="text-decoration: underline;">1</span>993      6 <span style="text-decoration: underline;">135</span>510    17.5  4.98<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 4.04<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 6.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 15-19 Female  <span style="text-decoration: underline;">1</span>994      9 <span style="text-decoration: underline;">133</span>010    17.5  4.69<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.68<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15-19 Female  <span style="text-decoration: underline;">1</span>995      6 <span style="text-decoration: underline;">131</span>960    17.5  4.66<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.88<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 15-19 Female  <span style="text-decoration: underline;">1</span>996      3 <span style="text-decoration: underline;">132</span>490    17.5  4.55<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.79<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.57<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 15-19 Female  <span style="text-decoration: underline;">1</span>997      9 <span style="text-decoration: underline;">132</span>590    17.5  4.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.33<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> <span style="color: #949494;">&lt;dbl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: .observed &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rates_agetime_bysex_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.fitted</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.observed</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>We use the <em>components</em> function to extract the model-based
estimates of age effects, and plot them.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="va">res_agetime_bysex</span>, what <span class="op">=</span> <span class="st">"age_effect"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">age_effect</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   sex    age   age.mid .fitted .lower .upper .probability </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Female 15-19    17.5  -<span style="color: #BB0000;">4.64</span>  -<span style="color: #BB0000;">4.78</span>  -<span style="color: #BB0000;">4.50</span>  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Female 20-24    22.5  -<span style="color: #BB0000;">0.593</span> -<span style="color: #BB0000;">0.616</span> -<span style="color: #BB0000;">0.570</span> <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Female 25-29    27.5   0.768  0.749  0.787 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Female 30-34    32.5   1.18   1.17   1.20  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Female 35-39    37.5   1.27   1.25   1.28  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Female 40-44    42.5   1.27   1.26   1.29  <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">age_effect</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, y <span class="op">=</span> <span class="va">.fitted</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p>We use the <em>components</em> function to extract the model-based
estimates of time effects, and plot them.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="va">res_agetime_bysex</span>, what <span class="op">=</span> <span class="st">"time_effect"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">time_effect</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   sex    age   age.mid  time .fitted .lower .upper .probability </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Female 15-19    17.5  <span style="text-decoration: underline;">1</span>992   0.640  0.475  0.805 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Female 15-19    17.5  <span style="text-decoration: underline;">1</span>993   0.585  0.433  0.744 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Female 15-19    17.5  <span style="text-decoration: underline;">1</span>994   0.535  0.385  0.676 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Female 15-19    17.5  <span style="text-decoration: underline;">1</span>995   0.530  0.388  0.663 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Female 15-19    17.5  <span style="text-decoration: underline;">1</span>996   0.505  0.369  0.634 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Female 15-19    17.5  <span style="text-decoration: underline;">1</span>997   0.466  0.333  0.587 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">time_effect</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age.mid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.fitted</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>We obtain estimates of the total rates and plot them.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">total_rate</span> <span class="op">=</span> <span class="fu"><a href="../reference/total_rate.html">total_rate</a></span><span class="op">(</span><span class="va">res_agetime_bysex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">total_rate</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 7</span></span></span>
<span><span class="co">#&gt;    sex     time .fitted .lower .upper .probability  .observed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Female  <span style="text-decoration: underline;">1</span>992   0.369  0.361  0.376 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.369</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Female  <span style="text-decoration: underline;">1</span>993   0.367  0.359  0.374 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.367</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Female  <span style="text-decoration: underline;">1</span>994   0.362  0.355  0.369 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.361</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Female  <span style="text-decoration: underline;">1</span>995   0.368  0.361  0.376 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Female  <span style="text-decoration: underline;">1</span>996   0.377  0.370  0.385 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.379</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Female  <span style="text-decoration: underline;">1</span>997   0.363  0.357  0.371 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.363</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Female  <span style="text-decoration: underline;">1</span>998   0.370  0.363  0.378 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.371</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Female  <span style="text-decoration: underline;">1</span>999   0.364  0.357  0.370 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.364</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Female  <span style="text-decoration: underline;">2</span>000   0.354  0.347  0.361 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.354</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Female  <span style="text-decoration: underline;">2</span>001   0.352  0.345  0.359 <span style="color: #949494;">&lt;dbl [1,000]&gt;</span>     0.352</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">total_rate</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">.fitted</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.observed</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vig1_nz_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Bryant, Junni Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
